
Server listens on port 5566, connect to it with an ordinary socket.

Packets are utf-8 encoded json objects formated onto a single line.

Every packet must contain a "method" field
Every packet can also optionally contain a "data" feild;

You can test by using telnet:

> telnet babylon.vrsites.com 5566

Copy and past the examples below to see how it works


Client -> Server Methods:

Need to do this before anything else, roomId is the room you are starting in,you will be subscribed to that rooms events

{"method":"logon","data":{"userId":"LL", "version":"23.4","roomId":"345678354764987457"}}

Version is the client version, TODO: Reject incompatable clients

Logon will fail if a client is already using that name TODO: Add authentication

Will receive: {"method":"okay"} if everything was okay or a {"method":"error", "data":{"message": "Some error string"}}

When you pass through a portal:

{"method":"enter_room", "data": { "roomId": "345678354764987457" }}

When the user position has moved:

{"method":"move", "data": [0,0,0,0,0,0,0] }

Data can be anything you like, it will be passed to observers without validation

When the user wants to send a text message:

{"method":"chat", "data": "The message"}

You can pass anything through the data field and it will be sent to all clients subscribed to the current room.

When you wish to start receiving events about a room (you are in that room or looking through a portal)

{"method":"subscribe", "data": { "roomId": "345678354764987457" }}

Will receive: {"method":"okay"} if everything was okay

When you no longer wish to receive messages from that room because none of its portals are visible

{"method":"unsubscribe", "data": { "roomId": "345678354764987457" }}

Will receive: {"method":"okay"} if everything was okay


Server -> Client Notifications:

When a user moves in any room that you are subscribed too, will recive notification about your own movement

{"method":"user_moved","data":{"roomId":"fgdgd","userId":"LL","position":[0,0,0,0,0,0,0]}}

When a user says something in text chat

{"method":"user_chat", "data":{"message":"The message", "userId":"LL"}}

When a user changes room:

{"method":"user_entered", :{"userId":"LL","roomId":"345678354764987457"}}
